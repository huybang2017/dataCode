package HandleList;

import AbstractCore.TypeList;
import handleMaganement.ObjCustomer.Customer;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Scanner;

public class ListCustomer implements TypeList {
    private int n;
    private Customer[] listCustomer;
    private Scanner sc = new Scanner(System.in);

    public ListCustomer() {
        n = 0;
        // Initialize the array with a reasonable initial size
        listCustomer = new Customer[10];
    }

    public static void printLine() {
        for (int i = 0; i < 130; i++) {
            System.out.print("=");
        }
        System.out.println();
    }

    public int countCustomer() {
        int count = 0;
        try (BufferedReader bufferedReader = new BufferedReader(new FileReader("/path/to/customer/data/file.txt", StandardCharsets.UTF_8))) {
            while (bufferedReader.readLine() != null) {
                count++;
            }
            n = count;
        } catch (IOException e) {
            e.printStackTrace();
        }
        return count;
    }

    public void readListCustomer() {
        try {
            ArrayList<String> data = readDataFromFile("/path/to/customer/data/file.txt");
            n = data.size();
            listCustomer = new Customer[n];

            for (int i = 0; i < n; i++) {
                listCustomer[i] = new Customer();
                listCustomer[i].getLineFromFile(data.get(i));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void updateListCustomer() {
        try {
            writeDataToFile("/path/to/customer/data/file.txt", getCustomerDataList());
            System.out.println("Da cap nhat danh sach");
            display();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private ArrayList<String> readDataFromFile(String filePath) throws IOException {
        ArrayList<String> data = new ArrayList<>();
        try (BufferedReader bufferedReader = new BufferedReader(new FileReader(filePath, StandardCharsets.UTF_8))) {
            String line;
            while ((line = bufferedReader.readLine()) != null) {
                data.add(line);
            }
        }
        return data;
    }

    private void writeDataToFile(String filePath, ArrayList<String> data) throws IOException {
        try (FileWriter fileWriter = new FileWriter(filePath, StandardCharsets.UTF_8)) {
            for (String line : data) {
                fileWriter.write(line + System.lineSeparator());
            }
        }
    }

    private ArrayList<String> getCustomerDataList() {
        ArrayList<String> dataList = new ArrayList<>();
        for (int i = 0; i < n; i++) {
            if (listCustomer[i] != null) {
                String line = listCustomer[i].InfoCustomer();
                dataList.add(line);
            }
        }
        return dataList;
    }

    public void addToListCustomer(Customer customer) {
        if (n == listCustomer.length) {
            listCustomer = Arrays.copyOf(listCustomer, n * 2);
        }
        listCustomer[n] = customer;
        n++;
        updateListCustomer();
    }

    @Override
    public void add() {
        // Implement the logic to add a customer to the list
    }

    @Override
    public void edit() {
        // Implement the logic to edit a customer in the list
    }

    @Override
    public void remove() {
        // Implement the logic to remove a customer from the list
    }

    @Override
    public void find() {
        // Implement the logic to find a customer in the list
    }

    @Override
    public void display() {
        // Implement the logic to display the list of customers
    }
}
